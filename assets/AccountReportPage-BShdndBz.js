import{q as A,r as c,t as w,j as e,T as C,K as E,o as m,G as b,_ as f}from"./index-HH_UOIZx.js";import{D as G,a as Q}from"./DateIcon-COKakmTY.js";import{u as Y}from"./useQuery-CfinWix-.js";import{a as x}from"./axiosInstance-f51KjAOb.js";import{u as _}from"./useGetAccountList-CvKiyq5C.js";import{u as T}from"./useMutation-Dn-P9RO6.js";import{C as M}from"./Center-DnD7M4rk.js";import{S as N}from"./Stack-CJLiOtGk.js";import{L as O,B as p}from"./Button-BxVRjdO9.js";import{S as v}from"./Select-DmDJsrLN.js";import{N as o}from"./NumberInput-C3nc0w_S.js";import{T as z}from"./Textarea-D2hRWm4X.js";import"./createReactComponent-BvNoKUJd.js";import"./InputBase-BzmGfW4v.js";const H=async r=>await(await x.get(`/v1/total-account-reports?exact=${r}`)).data.data,K=r=>Y({queryKey:["account-report",r],queryFn:()=>H(r),select:s=>s}),V=async r=>{await x.post("/account-balance",r)},L=()=>{const r=A();return T({mutationFn:V,onSuccess:()=>{r.invalidateQueries(["account-report"])}})},$=async r=>{await x.post("/transfer",r)},J=()=>{const r=A();return T({mutationFn:$,onSuccess:()=>{r.invalidateQueries(["account-report"])}})},U=()=>{const[r,s]=c.useState(""),[u,h]=c.useState(null),[d,g]=c.useState(null),[l,j]=c.useState(0),[i,y]=c.useState(new Date),{data:n}=_(),{data:a,isLoading:S}=K(w(i)),{mutate:D,isPending:B}=L(),{mutate:F,isPending:I}=J();console.log(a);const P=()=>{if(!u||!d||!i||!l){f.error("Something went wrong");return}const t=w(i),k={relatedAccounting:u,transferAmount:l,amount:(a==null?void 0:a.closingBalance)&&a.closingBalance-l,date:t,remark:r},q={fromAcc:u,toAcc:d,date:t,remark:r,amount:l};try{D(k),F(q),f.success("Transfer successful"),s(""),h(null),g(null),j(0)}catch{f.error("Fail to transfer")}};return e.jsx(M,{children:e.jsxs(N,{gap:10,align:"center",children:[e.jsx(C,{fw:600,fz:25,children:"Account Report for"}),e.jsxs(C,{mt:-20,fw:600,fz:22,children:["(",E(new Date).format("DD-MM-YYYY"),")"]}),S?e.jsx(O,{color:m}):e.jsxs(e.Fragment,{children:[e.jsx(G,{mt:-10,w:600,value:i,onChange:t=>y(t),label:"Opening Date",leftSection:e.jsx(Q,{}),leftSectionPointerEvents:"none",placeholder:"Enter date"}),e.jsxs(b,{wrap:"nowrap",w:600,align:"center",children:[e.jsx(v,{value:u,onChange:t=>h(t),w:"50%",placeholder:"From",label:"From account",allowDeselect:!1,data:n==null?void 0:n.map(t=>({label:t.subHeader,value:t._id}))}),e.jsx(v,{value:d,onChange:t=>g(t),w:"50%",placeholder:"To",label:"To account",allowDeselect:!1,data:n==null?void 0:n.map(t=>({label:t.subHeader,value:t._id}))})]}),e.jsx(o,{value:l,onChange:t=>j(Number(t)),label:"Transfer amount",w:600,hideControls:!0}),e.jsx(z,{value:r,onChange:t=>s(t.target.value),w:600,label:"Remark",placeholder:"enter remark"}),e.jsx(o,{value:a==null?void 0:a.todayVoucherIncome,label:"Today Voucher Income",w:600,disabled:!0,hideControls:!0}),e.jsx(o,{value:a==null?void 0:a.otherIncome,label:"Other Income",w:600,disabled:!0,hideControls:!0}),e.jsx(o,{value:a==null?void 0:a.expense,label:"Other Expense",w:600,disabled:!0,hideControls:!0}),e.jsx(o,{value:a==null?void 0:a.closingBalance,label:"Total",w:600,disabled:!0,hideControls:!0}),e.jsx(o,{label:"Closing Balance",value:a==null?void 0:a.closingBalance,w:600,disabled:!0,hideControls:!0})]}),e.jsxs(b,{mt:10,children:[e.jsx(p,{color:m,children:"Save"}),e.jsx(p,{loading:B||I,color:m,onClick:P,children:"Transfer"}),e.jsx(p,{color:m,variant:"outline",children:"Print"})]})]})})},me=()=>e.jsx(U,{});export{me as default};
