import{j as e,q as E,s as B,r as d,G as y,o as u,t as f,_ as v,F as P,B as A}from"./index-HH_UOIZx.js";import{R as k}from"./CommonTitle-CeQYZZhX.js";import{M as F,D as g,a as C}from"./DateIcon-COKakmTY.js";import{F as T}from"./FilterButton-D-icS8k3.js";import{D as R}from"./DataTable-DmZ13xqo.js";import{A as q}from"./ActionButton-DmpfxdBo.js";import{R as h,A as z}from"./AddButton-EMGjYyJp.js";import{z as i,u as G,a as H}from"./index-DOWDAM7u.js";import{u as N}from"./useGetAccountList-CvKiyq5C.js";import{u as _}from"./useMutation-Dn-P9RO6.js";import{a as D}from"./axiosInstance-f51KjAOb.js";import{S as b}from"./Stack-CJLiOtGk.js";import{S}from"./Select-DmDJsrLN.js";import{T as M}from"./TextInput-CnAMk_nK.js";import{N as Q}from"./NumberInput-C3nc0w_S.js";import{T as L}from"./Textarea-D2hRWm4X.js";import{B as I}from"./Button-BxVRjdO9.js";import{u as $}from"./useQuery-CfinWix-.js";import{C as j}from"./CommonHeader-DqpHyTMq.js";import"./createReactComponent-BvNoKUJd.js";import"./IconTrash-dlyoLBAc.js";import"./InputBase-BzmGfW4v.js";const K=()=>{const n=t=>{alert(t.no)},o=t=>{alert(t.no)};return[{name:"No",selector:t=>t.no,width:"70px"},{name:"Name",selector:t=>t.name,width:"100px"},{name:"Bank/Cash Account",selector:t=>t.account.subHeader,width:"300px"},{name:"Balance",selector:t=>t.account.openingBalance,width:"200px"},{name:"Amount",selector:t=>t.amount,width:"160px"},{name:"CreateAt",selector:t=>t.createdAt.split("T")[0],width:"180px"},{name:"Actions",cell:t=>e.jsx(q,{row:t,onDelete:()=>o(t),onEdit:()=>n(t)}),width:"200px"}]},V=i.object({name:i.string().min(1,"name is required"),account:i.string().min(1,"income account is required"),createdAt:i.date(),reason:i.string().min(1,"reason is required"),amount:i.number().min(1,"amount is required")}),W=async n=>{await D.post("/v1/income",n)},J=()=>{const n=E();return _({mutationFn:W,onSuccess:()=>{n.invalidateQueries(["income"])}})},O=()=>{const[n,{open:o,close:r}]=B(!1),[t,l]=d.useState("cash"),{mutate:p,isPending:m}=J(),{data:c}=N(),s=G({mode:"uncontrolled",initialValues:{name:"",account:"",amount:0,createdAt:new Date,reason:""},validate:H(V)}),x=a=>{const w={...a,createdAt:f(a.createdAt)};p(w,{onSuccess:()=>{v.success("Income created successfully"),s.reset(),r()},onError:()=>{v.error("Something went wrong")}})};return e.jsxs(e.Fragment,{children:[e.jsx(F,{size:550,centered:!0,opened:n,onClose:r,title:"Income Create",styles:{title:{fontSize:"20px",fontWeight:600}},children:e.jsxs(b,{children:[e.jsx(h.Group,{value:t,onChange:a=>l(a),children:e.jsxs(y,{mt:"xs",justify:"center",children:[e.jsx(h,{color:u,value:"cash",label:"Cash"}),e.jsx(h,{color:u,value:"bank",label:"Bank"})]})}),e.jsx("form",{onSubmit:s.onSubmit(x),children:e.jsxs(b,{children:[t==="cash"?e.jsx(S,{placeholder:"Enter cash account",label:"Cash Accounts",allowDeselect:!1,...s.getInputProps("account"),data:c==null?void 0:c.filter(a=>a.name==="Cash in Hand").map(a=>({label:a.subHeader,value:a._id}))}):e.jsx(S,{label:"Bank Accounts",placeholder:"Enter bank account",...s.getInputProps("account"),allowDeselect:!1,data:c==null?void 0:c.filter(a=>a.relatedHeader.name==="Cash at Bank").map(a=>({label:a.name,value:a._id}))}),e.jsx(M,{...s.getInputProps("name"),placeholder:"Enter name",label:"Name"}),e.jsx(Q,{...s.getInputProps("amount"),label:"Amount",placeholder:"Enter amount"}),e.jsx(g,{...s.getInputProps("createdAt"),label:"Date",leftSection:e.jsx(C,{}),leftSectionPointerEvents:"none",placeholder:"Enter date"}),e.jsx(L,{...s.getInputProps("reason"),label:"Reason",placeholder:"Enter reason"}),e.jsxs(y,{justify:"end",gap:15,mt:20,children:[e.jsx(I,{variant:"outline",radius:4,size:"sm",onClick:r,color:u,children:"Cancel"}),e.jsx(I,{loading:m,disabled:m,type:"submit",radius:4,size:"sm",color:u,children:"Create"})]})]})})]})}),e.jsx(z,{onClick:o,children:"Income"})]})},U=async(n,o)=>await(await D.get(`/v1/income?startDate=${n}&endDate=${o}`)).data.data,X=(n,o)=>$({queryKey:["income",n,o],queryFn:()=>U(n,o),select:r=>r.map((t,l)=>({...t,no:l+1}))}),Y=()=>{const n=K(),[o,r]=d.useState("all"),[t,l]=d.useState(null),[p,m]=d.useState(null),{data:c}=X(f(t)||"",f(t)||""),s=()=>{l(null),m(null)};return e.jsxs(b,{p:"sm",children:[e.jsxs(j,{children:[e.jsx(j.LeftSection,{title:"Income List"}),e.jsx(j.RightSection,{children:e.jsx(O,{})})]}),e.jsxs(P,{align:"center",gap:15,justify:"end",children:[e.jsx(k,{onClick:s}),e.jsx(g,{w:150,leftSection:e.jsx(C,{}),leftSectionPointerEvents:"none",placeholder:"Start date",value:t,onChange:l}),e.jsx(g,{w:150,leftSection:e.jsx(C,{}),leftSectionPointerEvents:"none",placeholder:"End date",value:p,onChange:m}),e.jsx(S,{allowDeselect:!1,w:150,value:o,onChange:x=>r(x),data:[{label:"All",value:"all"},{label:"Bank",value:"bank"},{label:"Cash",value:"cash"}]}),e.jsx(T,{}),e.jsx(I,{bg:u,children:"Export"})]}),e.jsx(A,{children:e.jsx(A,{children:e.jsx(R,{columns:n,data:c||[]})})})]})},Se=()=>e.jsx(Y,{});export{Se as default};
